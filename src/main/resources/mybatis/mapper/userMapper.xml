<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.azarenko.repository.UserRepository">

    <resultMap type="User" id="usermap">
        <id column="id" property="id" />
        <result column="name" property="name" />
        <result column="email" property="email" />
        <result column="password" property="password" />
        <result column="enabled" property="enabled"/>
        <result column="registered" property="registered" />
        <collection property="roles" javaType="Role" >
            <result column="role" property="role" />
        </collection>
    </resultMap>


    <select id="getByEmail" resultMap="usermap">
        SELECT u.id AS id, u.name AS name,
        u.email AS email, u.password AS password, u.enabled AS enabled,
        u.registration AS registration, r.role AS role, r.user_id AS user_id
       FROM users  u JOIN roles r ON u.id = r.user_id WHERE u.email=#{email}
    </select>


</mapper>